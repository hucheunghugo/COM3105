<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart - My Fancy Online Store</title>
    <link rel="stylesheet" href="styles.css">
  <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get all quantity input elements
            const quantityInputs = document.querySelectorAll('.quantity-input');

            // Get all item price elements
            const itemPrices = document.querySelectorAll('.item-price');

            // Get the total price element
            const totalPriceElement = document.getElementById('totalPrice');

            // Function to update the item price for a given input and item price element
            function updateItemPrice(input, itemPriceElement) {
                const quantity = parseInt(input.value) || 0;
                const pricePerItem = parseFloat(itemPriceElement.getAttribute('data-price')) || 0;
                const totalPriceForItem = quantity * pricePerItem;
                itemPriceElement.textContent = '$' + totalPriceForItem.toFixed(2);
            }

            // Function to update the total price based on item quantities
            function updateTotalPrice() {
                let total = 0;

                // Calculate the total price by summing up the item prices
                itemPrices.forEach((price) => {
                    total += parseFloat(price.textContent.replace('$', '')) || 0;
                });

                // Update the total price element with the calculated total
                totalPriceElement.textContent = '$' + total.toFixed(2);
            }

            // Add event listeners to quantity inputs for input events
            quantityInputs.forEach((input, index) => {
                input.addEventListener('input', () => {
                    updateItemPrice(input, itemPrices[index]);
                    updateTotalPrice();
                });
            });

            // Initialize item prices and total price
            itemPrices.forEach((itemPrice, index) => {
                updateItemPrice(quantityInputs[index], itemPrice);
            });
            updateTotalPrice();
        });
		
		 function redirectToCheckout() {
		
			var checkoutUrl = "approval.html";

			
			window.location.href = checkoutUrl;
		}
		
		
		function process2() {
			alert("Execute process()...");

			var pWin = window.open("http://localhost:3000/view_approval", "cWin", width="180", height="150");

		}
		
		
		function process(fm) {
		alert("Username length: " + document.querySelector("#username").value.length);
		alert("Qty: " + fm.qty.value);

		if (document.querySelector("#username").value.length < 1) {
			alert("Please enter UserName");
			document.querySelector("#username").focus();
			return false;
		} else {
			fm.f_username.value = document.querySelector("#username").value;
		}
	
		if (fm.qty.value < 1) {
			alert("QTY not selected, please select QTY");
			fm.qty.focus();
			return false;
		}
		var url = "http://localhost:3000/add_cart?prod_id=" + fm.prod_id.value + "&qty=" + fm.qty.value + "&price=" + fm.price.value + "&f_username=" + fm.f_username.value; 
		alert("url: " + url);
/*
		alert("Return false, not actually making a call");
		return false;
*/

		alert("return true: actually call program");
		return true;

	}

	function process_check_out(fm) {
		alert("Username length: " + document.querySelector("#username").value.length);
		if (document.querySelector("#username").value.length < 1) {
			alert("Please enter UserName");
			document.querySelector("#username").focus();
			return false;
		} else {
			fm.f_check_out_username.value = document.querySelector("#username").value;
		}
		var url = "http://localhost:3000/check_out?f_check_out_username=" + fm.f_check_out_username.value; 
		alert("url: " + url);
/*	
		alert("Return false, not actually making a call");
		return false;
*/
		alert("return true: actually call program");
		return true;
	
	}
		
		
			function process_check_out(fm) {
		alert("Username length: " + document.querySelector("#username").value.length);
		if (document.querySelector("#username").value.length < 1) {
			alert("Please enter UserName");
			document.querySelector("#username").focus();
			return false;
		} else {
			fm.f_check_out_username.value = document.querySelector("#username").value;
		}
		var url = "http://localhost:3000/check_out?f_check_out_username=" + fm.f_check_out_username.value; 
		alert("url: " + url);
/*	
		alert("Return false, not actually making a call");
		return false;
*/
		alert("return true: actually call program");
		return true;
	
	}
		
		
		
		
		
		
		
		
		
		
		
		
		
		
    </script>
</head>
<body>

    <header>
        <center>	
			<h1>	
				<table>
					<tr>
						<td>Welcome to </td>
						 <td rowspan="2"><a href="http://localhost:3000"><img src="logo.png"  width="150" height="120"  ></a></td>
						<td>Online Store</td>
					</tr>
				</table>
			</h1>
		</center>	
        <nav>
            <ul>
				<li><a href="http://localhost:3000">Home</a></li>
                <li><a href="http://localhost:3000/view_shop">Shop</a></li>
                <li><a href="http://localhost:3000/view_catalog">Cart</a></li>
                <li><a href="http://localhost:3000/view_contact">Contact</a></li>
            </ul>
        </nav>
    </header>

	<main>
	
		<h2>Your Shopping Cart:</h2></br>
		
		<div class="cart-items">
		
		<p>Customer User Name: 
				<select name="username" id="username">
					<option>cust1</option>
					<option>cust2</option>
					<option>cust3</option>
				</select>
			</p>
			<form name="f1" id="f1" method="get" target="_blank" action="http://localhost:3000/add_cart" onsubmit="return process(this)">
			<div class="cart-item">
				<img src="Angus Beef.jpg" alt="Angus Beef" width="150" height="120">
				<input type="hidden" name="f_username" id="f_username" value="">
				<div class="item-details">
					<input type="hidden" name="prod_id" id="prod_id" value="1">
					<h3>Angus Beef</h3>
					<input type="hidden" name="price" id="price" value="150">
					<p>Price: $150.00</p>
					<label for="quantity1">Quantity:</label>
						<td>
							<select name="qty" id="qty">
								<option>0</option>
								<option>1</option>
								<option>3</option>
								<option>4</option>
								<option>5</option>
								<option>6</option>
								<option>7</option>
								<option>8</option>
								<option>9</option>
								<option>10</option>
							</select>
						</td>
					
					<span class="item-price" id="itemPrice" data-price="150.00">$0</span></br>
					<input type="submit" value="Add to shopping cart" style="width: fit-content;"></td>
				</div>
			</div>
			</form>
			<form name="f2" id="f2" method="get" target="_blank" action="http://localhost:3000/add_cart" onsubmit="return process(this)">
			<div class="cart-item">
				<img src="Red King Crab.jpg" alt="Red King Crab" width="150" height="120">
				<div class="item-details">
					<input type="hidden" name="prod_id" id="prod_id" value="2">
					<input type="hidden" name="f_username" id="f_username" value="">
					<h3>Red King Crab</h3>
					<input type="hidden" name="price" id="price" value="350">
					<p>Price: $350.00</p>
					<label for="quantity2">Quantity:</label>
						<td>
							<select name="qty" id="qty">
								<option>0</option>
								<option>1</option>
								<option>3</option>
								<option>4</option>
								<option>5</option>
								<option>6</option>
								<option>7</option>
								<option>8</option>
								<option>9</option>
								<option>10</option>
							</select>
						</td>
					<span class="item-price" id="itemPrice" data-price="350.00">$0</span></br>
					<input type="submit" value="Add to shopping cart" style="width: fit-content;"></td>
				</div>
			</div>
			</form>
			<form name="f3" id="f3" method="get" target="_blank" action="http://localhost:3000/add_cart" onsubmit="return process(this)">
			<div class="cart-item">
				<img src="Norway Premium Smoked Salmon.jpg" alt="Norway Premium Smoked Salmon" width="150" height="120">
				<div class="item-details">
					<input type="hidden" name="prod_id" id="prod_id" value="3">
					<input type="hidden" name="f_username" id="f_username" value="">
					<h3>Norway Premium Smoked Salmon</h3>
					<input type="hidden" name="price" id="price" value="65">
					<p>Price: $65.00</p>
					<label for="quantity3">Quantity:</label>
						<td>
							<select name="qty" id="qty">
								<option>0</option>
								<option>1</option>
								<option>3</option>
								<option>4</option>
								<option>5</option>
								<option>6</option>````````````
								<option>7</option>
								<option>8</option>
								<option>9</option>
								<option>10</option>
							</select>
						</td>
					<span class="item-price" id="itemPrice" data-price="65.00">$0</span></br>
					<input type="submit" value="Add to shopping cart" style="width: fit-content;"></td>
			</form>
				</div>
			</div>
		</div>
		<div class="cart-total">
			<h3>Total: <span id="totalPrice">$100.00</span></h3>
			
			<form name="f_checkout" id="f_checkout" method="get" action="http://localhost:3000/check_out" onsubmit="return process_check_out(this)">
			<input type="hidden" name="f_check_out_username" id="f_check_out_username" value="">
			<input type="submit" value = "Proceed to Checkout" class="checkout-button" style="width: fit-content;">	
			</form>

		</div>
	</main>





    <footer>
        <p>&copy; 2023 My Fancy Online Store</p>
    </footer>
</body>
</html>
